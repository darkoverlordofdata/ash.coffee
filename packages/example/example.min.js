!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Example=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";var c;b.exports=c=function(){function a(){}return a}(),c.input=function(){function a(){}return a}(),a("./src/input/key_poll"),c.ui=function(){function a(){}return a}(),a("./src/ui/point"),c.graphics=function(){function a(){}return a}(),a("./src/graphics/asteroid_view"),a("./src/graphics/asteroid_death_view"),a("./src/graphics/bullet_view"),a("./src/graphics/hud_view"),a("./src/graphics/spaceship_death_view"),a("./src/graphics/spaceship_view"),a("./src/graphics/wait_for_start_view"),c.components=function(){function a(){}return a}(),a("./src/components/animation"),a("./src/components/asteroid"),a("./src/components/audio"),a("./src/components/bullet"),a("./src/components/collision"),a("./src/components/death_throes"),a("./src/components/display"),a("./src/components/game_state"),a("./src/components/gun"),a("./src/components/gun_controls"),a("./src/components/hud"),a("./src/components/motion"),a("./src/components/motion_controls"),a("./src/components/position"),a("./src/components/spaceship"),a("./src/components/wait_for_start"),c.nodes=function(){function a(){}return a}(),a("./src/nodes/animation_node"),a("./src/nodes/asteroid_collision_node"),a("./src/nodes/audio_node"),a("./src/nodes/bullet_age_node"),a("./src/nodes/bullet_collision_node"),a("./src/nodes/death_throes_node"),a("./src/nodes/game_node"),a("./src/nodes/gun_control_node"),a("./src/nodes/hud_node"),a("./src/nodes/motion_control_node"),a("./src/nodes/movement_node"),a("./src/nodes/render_node"),a("./src/nodes/spaceship_collision_node"),a("./src/nodes/spaceship_node"),a("./src/nodes/wait_for_start_node"),c.systems=function(){function a(){}return a}(),a("./src/systems/animation_system"),a("./src/systems/audio_system"),a("./src/systems/bullet_age_system"),a("./src/systems/collision_system"),a("./src/systems/death_throes_system"),a("./src/systems/game_manager"),a("./src/systems/gun_control_system"),a("./src/systems/hud_system"),a("./src/systems/motion_control_system"),a("./src/systems/movement_system"),a("./src/systems/render_system"),a("./src/systems/system_priorities"),a("./src/systems/wait_for_start_system"),a("./src/entity_creator"),a("./src/game_config"),a("./src/asteroids"),a("./src/main")},{"./src/asteroids":2,"./src/components/animation":3,"./src/components/asteroid":4,"./src/components/audio":5,"./src/components/bullet":6,"./src/components/collision":7,"./src/components/death_throes":8,"./src/components/display":9,"./src/components/game_state":10,"./src/components/gun":11,"./src/components/gun_controls":12,"./src/components/hud":13,"./src/components/motion":14,"./src/components/motion_controls":15,"./src/components/position":16,"./src/components/spaceship":17,"./src/components/wait_for_start":18,"./src/entity_creator":19,"./src/game_config":20,"./src/graphics/asteroid_death_view":21,"./src/graphics/asteroid_view":22,"./src/graphics/bullet_view":23,"./src/graphics/hud_view":24,"./src/graphics/spaceship_death_view":25,"./src/graphics/spaceship_view":26,"./src/graphics/wait_for_start_view":27,"./src/input/key_poll":28,"./src/main":29,"./src/nodes/animation_node":30,"./src/nodes/asteroid_collision_node":31,"./src/nodes/audio_node":32,"./src/nodes/bullet_age_node":33,"./src/nodes/bullet_collision_node":34,"./src/nodes/death_throes_node":35,"./src/nodes/game_node":36,"./src/nodes/gun_control_node":37,"./src/nodes/hud_node":38,"./src/nodes/motion_control_node":39,"./src/nodes/movement_node":40,"./src/nodes/render_node":41,"./src/nodes/spaceship_collision_node":42,"./src/nodes/spaceship_node":43,"./src/nodes/wait_for_start_node":44,"./src/systems/animation_system":45,"./src/systems/audio_system":46,"./src/systems/bullet_age_system":47,"./src/systems/collision_system":48,"./src/systems/death_throes_system":49,"./src/systems/game_manager":50,"./src/systems/gun_control_system":51,"./src/systems/hud_system":52,"./src/systems/motion_control_system":53,"./src/systems/movement_system":54,"./src/systems/render_system":55,"./src/systems/system_priorities":56,"./src/systems/wait_for_start_system":57,"./src/ui/point":58}],2:[function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;t=a("../../lib"),u=a("../../example"),b=u.systems.AnimationSystem,c=u.systems.AudioSystem,d=u.systems.BulletAgeSystem,e=u.systems.CollisionSystem,f=u.systems.DeathThroesSystem,i=u.systems.GameManager,k=u.systems.GunControlSystem,l=u.systems.HudSystem,n=u.systems.MotionControlSystem,o=u.systems.MovementSystem,q=u.systems.RenderSystem,r=u.systems.SystemPriorities,s=u.systems.WaitForStartSystem,p=u.systems.PhysicsSystem,j=u.components.GameState,g=u.EntityCreator,h=u.GameConfig,m=u.input.KeyPoll,u.Asteroids=function(){function a(a,b,c){this.container=a,this.prepare(b,c)}return a.prototype.container=null,a.prototype.engine=null,a.prototype.tickProvider=null,a.prototype.creator=null,a.prototype.keyPoll=null,a.prototype.config=null,a.prototype.prepare=function(a,j){this.engine=new t.core.Engine,this.creator=new g(this.engine,this.container,this.world),this.keyPoll=new m(window),this.config=new h,this.config.height=j,this.config.width=a,this.engine.addSystem(new s(this.creator),r.preUpdate),this.engine.addSystem(new i(this.creator,this.config),r.preUpdate),this.engine.addSystem(new n(this.keyPoll),r.update),this.engine.addSystem(new k(this.keyPoll,this.creator),r.update),this.engine.addSystem(new d(this.creator),r.update),this.engine.addSystem(new f(this.creator),r.update),this.engine.addSystem(new o(this.config),r.move),this.engine.addSystem(new e(this.creator),r.resolveCollisions),this.engine.addSystem(new b,r.animate),this.engine.addSystem(new l,r.animate),this.engine.addSystem(new q(this.container),r.render),this.engine.addSystem(new c,r.render),this.creator.createWaitForClick(),this.creator.createGame()},a.prototype.start=function(){var a,b,c;navigator.isCocoonJS?a=null:(b=Math.floor(this.config.width/2)-40,c=0,a=new Stats,a.setMode(0),a.domElement.style.position="absolute",a.domElement.style.left=""+b+"px",a.domElement.style.top=""+c+"px",document.body.appendChild(a.domElement)),this.tickProvider=new t.tick.FrameTickProvider(a),this.tickProvider.add(this.engine.update),this.tickProvider.start()},a}()},{"../../example":1,"../../lib":92}],3:[function(a){"use strict";var b;b=a("../../../example"),b.components.Animation=function(){function a(a){this.animation=a}return a.prototype.animation=null,a}()},{"../../../example":1}],4:[function(a){"use strict";var b;b=a("../../../example"),b.components.Asteroid=function(){function a(a){this.fsm=a}return a.prototype.fsm=null,a}()},{"../../../example":1}],5:[function(a){"use strict";var b;b=a("../../../example"),b.components.Audio=function(){function a(){this.toPlay=[]}return a.prototype.toPlay=null,a.prototype.play=function(a){return this.toPlay.push(a)},a}()},{"../../../example":1}],6:[function(a){"use strict";var b;b=a("../../../example"),b.components.Bullet=function(){function a(a){this.lifeRemaining=a}return a.prototype.lifeRemaining=0,a}()},{"../../../example":1}],7:[function(a){"use strict";var b;b=a("../../../example"),b.components.Collision=function(){function a(a){this.radius=a}return a.prototype.radius=0,a}()},{"../../../example":1}],8:[function(a){"use strict";var b;b=a("../../../example"),b.components.DeathThroes=function(){function a(a){this.countdown=a}return a.prototype.countdown=0,a}()},{"../../../example":1}],9:[function(a){"use strict";var b;b=a("../../../example"),b.components.Display=function(){function a(a){this.graphic=a}return a.prototype.graphic=0,a}()},{"../../../example":1}],10:[function(a){"use strict";var b;b=a("../../../example"),b.components.GameState=function(){function a(){}return a.prototype.lives=3,a.prototype.level=0,a.prototype.hits=0,a.prototype.playing=!1,a.prototype.setForStart=function(){this.lives=3,this.level=0,this.hits=0,this.playing=!0},a}()},{"../../../example":1}],11:[function(a){"use strict";var b,c;c=a("../../../example"),b=c.ui.Point,c.components.Gun=function(){function a(a,c,d,e){this.minimumShotInterval=d,this.bulletLifetime=e,this.shooting=!1,this.offsetFromParent=null,this.timeSinceLastShot=0,this.offsetFromParent=new b(a,c)}return a.prototype.shooting=!1,a.prototype.offsetFromParent=null,a.prototype.timeSinceLastShot=0,a.prototype.offsetFromParent=null,a}()},{"../../../example":1}],12:[function(a){"use strict";var b;b=a("../../../example"),b.components.GunControls=function(){function a(a){this.trigger=a}return a.prototype.trigger=0,a}()},{"../../../example":1}],13:[function(a){"use strict";var b;b=a("../../../example"),b.components.Hud=function(){function a(a){this.view=a}return a.prototype.view=null,a}()},{"../../../example":1}],14:[function(a){"use strict";var b,c;c=a("../../../example"),b=c.ui.Point,c.components.Motion=function(){function a(a,c,d,e){this.angularVelocity=d,this.damping=e,this.velocity=new b(a,c)}return a.prototype.velocity=null,a.prototype.angularVelocity=0,a.prototype.damping=0,a}()},{"../../../example":1}],15:[function(a){"use strict";var b;b=a("../../../example"),b.components.MotionControls=function(){function a(a,b,c,d,e){this.left=a,this.right=b,this.accelerate=c,this.accelerationRate=d,this.rotationRate=e}return a.prototype.left=0,a.prototype.right=0,a.prototype.accelerate=0,a.prototype.accelerationRate=0,a.prototype.rotationRate=0,a}()},{"../../../example":1}],16:[function(a){"use strict";var b,c;c=a("../../../example"),b=c.ui.Point,c.components.Position=function(){function a(a,c,d){this.rotation=d,this.position=new b(a,c)}return a.prototype.position=null,a.prototype.rotation=0,a}()},{"../../../example":1}],17:[function(a){"use strict";var b;b=a("../../../example"),b.components.Spaceship=function(){function a(a){this.fsm=a}return a.prototype.fsm=null,a}()},{"../../../example":1}],18:[function(a){"use strict";var b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=a("../../../example"),b.components.WaitForStart=function(){function a(a){this.waitForStart=a,this.setStartGame=c(this.setStartGame,this),this.waitForStart.click.add(this.setStartGame)}return a.prototype.waitForStart=null,a.prototype.startGame=!1,a.prototype.setStartGame=function(){this.startGame=!0},a}()},{"../../../example":1}],19:[function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;B=a("../../lib"),C=a("../../example"),A=C.graphics.WaitForStartView,l=B.core.Entity,m=B.fsm.EntityStateMachine,b=C.components.Animation,c=C.components.Asteroid,f=C.components.Audio,g=C.components.Bullet,i=C.components.Collision,j=C.components.DeathThroes,k=C.components.Display,n=C.components.GameState,o=C.components.Gun,p=C.components.GunControls,q=C.components.Hud,s=C.components.Motion,t=C.components.MotionControls,u=C.components.Physics,v=C.components.Position,w=C.components.Spaceship,z=C.components.WaitForStart,d=C.graphics.AsteroidDeathView,e=C.graphics.AsteroidView,h=C.graphics.BulletView,r=C.graphics.HudView,x=C.graphics.SpaceshipDeathView,y=C.graphics.SpaceshipView,C.EntityCreator=function(){function a(a,b,c){this.engine=a,this.graphic=b,this.world=c}var u,B,C,D;return u=37,C=38,B=39,D=90,a.prototype.engine=null,a.prototype.waitEntity=null,a.prototype.graphic=null,a.prototype.destroyEntity=function(a){this.engine.removeEntity(a)},a.prototype.createGame=function(){var a,b;return b=new r(this.graphic),a=new l("game").add(new n).add(new q(b)).add(new k(b)).add(new v(0,0,0,0)),this.engine.addEntity(a),a},a.prototype.createWaitForClick=function(){var a;return this.waitEntity||(a=new A(this.graphic),this.waitEntity=new l("wait").add(new z(a)).add(new k(a)).add(new v(0,0,0,0))),this.waitEntity.get(z).startGame=!1,this.engine.addEntity(this.waitEntity),this.waitEntity},a.prototype.createSpaceshipWithoutFsm=function(){var a;return a=(new l).add(new w).add(new v(300,225,0)).add(new f).add(new s(0,0,0,15)).add(new t(u,B,C,100,3)).add(new o(8,0,.3,2)).add(new p(D)).add(new i(9)).add(new k(new y(this.graphic))),this.engine.addEntity(a),a},a.prototype.createAsteroidWithoutFsm=function(a,b,d){var g;return g=(new l).add(new c).add(new v(b,d,0)).add(new f).add(new s(4*(Math.random()-.5)*(50-a),4*(Math.random()-.5)*(50-a),2*Math.random()-1,0)).add(new i(a)).add(new k(new e(this.graphic,a))),this.engine.addEntity(g),g},a.prototype.createAsteroid=function(a,g,h){var n,o,p;return n=new l,p=new m(n),p.createState("alive").add(s).withInstance(new s(4*(Math.random()-.5)*(50-a),4*(Math.random()-.5)*(50-a),2*Math.random()-1,0)).add(i).withInstance(new i(a)).add(k).withInstance(new k(new e(this.graphic,a))),o=new d(this.graphic,a),p.createState("destroyed").add(j).withInstance(new j(3)).add(k).withInstance(new k(o)).add(b).withInstance(new b(o)),n.add(new c(p)).add(new v(g,h,0)).add(new f),p.changeState("alive"),this.engine.addEntity(n),n},a.prototype.createSpaceship=function(){var a,c,d;return d=new l,c=new m(d),c.createState("playing").add(s).withInstance(new s(0,0,0,15)).add(t).withInstance(new t(u,B,C,100,3)).add(o).withInstance(new o(8,0,.3,2)).add(p).withInstance(new p(D)).add(i).withInstance(new i(9)).add(k).withInstance(new k(new y(this.graphic))),a=new x(this.graphic),c.createState("destroyed").add(j).withInstance(new j(5)).add(k).withInstance(new k(a)).add(b).withInstance(new b(a)),d.add(new w(c)).add(new v(300,225,0)).add(new f),c.changeState("playing"),this.engine.addEntity(d),d},a.prototype.createUserBullet=function(a,b){var c,d,e,f,j;return d=Math.cos(b.rotation),e=Math.sin(b.rotation),f=d*a.offsetFromParent.x-e*a.offsetFromParent.y+b.position.x,j=e*a.offsetFromParent.x+d*a.offsetFromParent.y+b.position.y,c=(new l).add(new g(a.bulletLifetime)).add(new v(f,j,0)).add(new i(0)).add(new s(150*d,150*e,0,0)).add(new k(new h(this.graphic))),this.engine.addEntity(c),c},a}()},{"../../example":1,"../../lib":92}],20:[function(a){"use strict";var b;b=a("../../example"),b.GameConfig=function(){function a(){}return a.prototype.width=0,a.prototype.height=0,a}()},{"../../example":1}],21:[function(a){"use strict";var b,c,d;d=a("../../../example"),c=d.ui.Point,d.graphics.AsteroidDeathView=function(){function a(a,b){this.graphic=a,this.radius=b,this.dots=[]}var c;return c=8,a.prototype.dots=null,a.prototype.x=0,a.prototype.y=0,a.prototype.width=0,a.prototype.height=0,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.radius=0,a.prototype.points=null,a.prototype.count=0,a.prototype.first=!0,a.prototype.animate=function(a){var d,e,f,g,h,i;if(this.first)for(this.first=!1,e=f=0;c>=0?c>f:f>c;e=c>=0?++f:--f)d=new b(this.graphic,this.radius),this.dots.push(d);for(i=this.dots,g=0,h=i.length;h>g;g++)d=i[g],d.x+=d.velocity.x*a,d.y+=d.velocity.y*a;return this.draw()},a.prototype.draw=function(){var a,b,c,d,e;for(d=this.dots,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.draw(this.x,this.y));return e},a}(),b=function(){function a(a,b){var d,e,f;this.graphic=a,d=2*Math.random()*Math.PI,e=Math.random()*b,this.x=Math.cos(d)*e,this.y=Math.sin(d)*e,f=10*Math.random()+10,this.velocity=new c(Math.cos(d)*f,Math.sin(d)*f)}return a.prototype.velocity=null,a.prototype.graphic=null,a.prototype.x1=0,a.prototype.y1=0,a.prototype.x=0,a.prototype.y=0,a.prototype.draw=function(a,b){var c;c=this.graphic,c.save(),c.beginPath(),c.translate(a,b),c.rotate(this.rotation),c.fillStyle="#FFFFFF",c.arc(this.x,this.y,2,0,2*Math.PI,!1),c.fill(),c.restore()},a}()},{"../../../example":1}],22:[function(a){"use strict";var b;b=a("../../../example"),b.graphics.AsteroidView=function(){function a(a,b){var c,d,e,f;for(this.graphic=a,this.radius=b,this.width=this.radius,this.height=this.radius,this.points=[],c=0;c<2*Math.PI;)d=(.75+.25*Math.random())*this.radius,e=Math.cos(c)*d,f=Math.sin(c)*d,this.points.push({x:e,y:f}),c+=.5*Math.random()}return a.prototype.x=0,a.prototype.y=0,a.prototype.width=0,a.prototype.height=0,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.radius=0,a.prototype.points=null,a.prototype.count=0,a.prototype.draw=function(){var a,b;for(a=this.graphic,a.save(),a.beginPath(),a.translate(this.x,this.y),a.rotate(this.rotation),a.fillStyle="#FFFFFF",a.moveTo(this.radius,0),b=0;b<this.points.length;)a.lineTo(this.points[b].x,this.points[b].y),++b;a.lineTo(this.radius,0),a.fill(),a.restore()},a}()},{"../../../example":1}],23:[function(a){"use strict";var b;b=a("../../../example"),b.graphics.BulletView=function(){function a(a){this.graphic=a}return a.prototype.x=0,a.prototype.y=0,a.prototype.width=4,a.prototype.height=4,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.draw=function(){var a;a=this.graphic,a.save(),a.beginPath(),a.rotate(this.rotation),a.fillStyle="#FFFFFF",a.arc(this.x,this.y,2,0,2*Math.PI,!1),a.fill(),a.restore()},a}()},{"../../../example":1}],24:[function(a){"use strict";var b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=a("../../../example"),b.graphics.HudView=function(){function a(a){this.graphic=a,this.setScore=c(this.setScore,this),this.setLives=c(this.setLives,this),this.draw=c(this.draw,this),this.drawScore=this.createScore,this.drawLives=this.createLives}return a.prototype.x=0,a.prototype.y=0,a.prototype.width=4,a.prototype.height=4,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.score=0,a.prototype.lives=3,a.prototype.drawScore=null,a.prototype.drawLives=null,a.prototype.draw=function(){this.drawScore(),this.drawLives()},a.prototype.setLives=function(a){return this.lives=a},a.prototype.setScore=function(a){return this.score=a},a.prototype.createLives=function(){var a,b,c,d;this.graphic.save(),this.graphic.beginPath(),this.graphic.font="bold 18px Helvetica",this.graphic.fillStyle="#FFFFFF",this.graphic.textAlign="center",b="LIVES: "+this.lives,a=this.graphic.measureText(b),c=a.width,d=20,this.graphic.fillText(b,c,d),this.graphic.fill(),this.graphic.restore()},a.prototype.createScore=function(){var a,b,c,d;this.graphic.save(),this.graphic.beginPath(),this.graphic.font="bold 18px Helvetica",this.graphic.fillStyle="#FFFFFF",this.graphic.textAlign="center",b="SCORE: "+this.score,a=this.graphic.measureText(b),c=window.window.innerWidth*window.devicePixelRatio-a.width,d=20,this.graphic.fillText(b,c,d),this.graphic.fill(),this.graphic.restore()},a}()},{"../../../example":1}],25:[function(a){"use strict";var b,c;c=a("../../../example"),b=c.ui.Point,c.graphics.SpaceshipDeathView=function(){function a(a){this.graphic=a}return a.prototype.x=0,a.prototype.y=0,a.prototype.width=20,a.prototype.height=20,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.vel1=null,a.prototype.vel2=null,a.prototype.rot1=null,a.prototype.rot2=null,a.prototype.x1=0,a.prototype.y2=0,a.prototype.y1=0,a.prototype.y2=0,a.prototype.first=!0,a.prototype.animate=function(a){return this.first&&(this.first=!1,this.vel1=new b(10*Math.random()-5,10*Math.random()+10),this.vel2=new b(10*Math.random()-5,-(10*Math.random()+10)),this.rot1=300*Math.random()-150,this.rot2=300*Math.random()-150,this.x1=this.x2=this.x,this.y1=this.y2=this.y,this.r1=this.r2=this.rotation),this.x1+=this.vel1.x*a,this.y1+=this.vel1.y*a,this.r1+=this.rot1*a,this.x2+=this.vel2.x*a,this.y2+=this.vel2.y*a,this.r2+=this.rot2*a,this.draw()},a.prototype.draw=function(){var a;a=this.graphic,a.save(),a.beginPath(),a.translate(this.x+this.x1,this.y+this.y1),a.rotate(this.r1),a.fillStyle="#FFFFFF",a.moveTo(10,0),a.lineTo(-7,7),a.lineTo(-4,0),a.lineTo(10,0),a.fill(),a.restore(),a.save(),a.beginPath(),a.translate(this.x+this.x2,this.y+this.y2),a.rotate(this.r2),a.fillStyle="#FFFFFF",a.moveTo(10,0),a.lineTo(-7,7),a.lineTo(-4,0),a.lineTo(10,0),a.fill(),a.restore()},a}()},{"../../../example":1}],26:[function(a){"use strict";var b;b=a("../../../example"),b.graphics.SpaceshipView=function(){function a(a){this.graphic=a}return a.prototype.x=0,a.prototype.y=0,a.prototype.width=20,a.prototype.height=20,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.draw=function(){var a;a=this.graphic,a.save(),a.beginPath(),a.translate(this.x,this.y),a.rotate(this.rotation),a.fillStyle="#FFFFFF",a.moveTo(10,0),a.lineTo(-7,7),a.lineTo(-4,0),a.lineTo(-7,-7),a.lineTo(10,0),a.fill(),a.restore()},a}()},{"../../../example":1}],27:[function(a){"use strict";var b,c,d;d=a("../../../example"),c=a("../../../lib"),b=c.signals.Signal0,d.graphics.WaitForStartView=function(){function a(a){this.graphic=a,this.click=new b,this.gameOver=this.createGameOver,this.instructions=this.createInstructions,this.clickToStart=this.createClickToStart,this.graphic.canvas.addEventListener("click",function(a){return function(){return a.click.dispatch()}}(this))}return a.prototype.x=0,a.prototype.y=0,a.prototype.width=4,a.prototype.height=4,a.prototype.rotation=0,a.prototype.graphic=null,a.prototype.gameOver=null,a.prototype.clickToStart=null,a.prototype.instructions=null,a.prototype.click=null,a.prototype.createGameOver=function(){var a,b,c,d;this.graphic.save(),this.graphic.beginPath(),this.graphic.font="bold 32px Helvetica",this.graphic.fillStyle="#FFFFFF",b="ASTEROIDS",a=this.graphic.measureText(b),c=Math.floor((window.innerWidth*window.devicePixelRatio-a.width)/2),d=175,this.graphic.fillText(b,c,d),this.graphic.fill(),this.graphic.restore()},a.prototype.createClickToStart=function(){var a,b,c,d;this.graphic.save(),this.graphic.beginPath(),this.graphic.font="bold 18px Helvetica",this.graphic.fillStyle="#FFFFFF",b="CLICK TO START",a=this.graphic.measureText(b),c=Math.floor((window.innerWidth*window.devicePixelRatio-a.width)/2),d=225,this.graphic.fillText(b,c,d),this.graphic.fill(),this.graphic.restore()},a.prototype.createInstructions=function(){var a,b,c,d;this.graphic.save(),this.graphic.beginPath(),this.graphic.font="bold 14px Helvetica",this.graphic.fillStyle="#FFFFFF",b="CTRL-Z to Fire  ~  Arrow Keys to Move",a=this.graphic.measureText(b),c=10,d=window.innerHeight*window.devicePixelRatio-20,this.graphic.fillText(b,c,d),this.graphic.fill(),this.graphic.restore()},a.prototype.draw=function(){this.gameOver(),this.clickToStart(),this.instructions()},a}()},{"../../../example":1,"../../../lib":92}],28:[function(a){"use strict";var b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=a("../../../example"),b.input.KeyPoll=function(){function a(a){this.displayObj=a,this.isUp=c(this.isUp,this),this.isDown=c(this.isDown,this),this.keyUpListener=c(this.keyUpListener,this),this.keyDownListener=c(this.keyDownListener,this),this.states={},this.displayObj.addEventListener("keydown",this.keyDownListener),this.displayObj.addEventListener("keyup",this.keyUpListener)}var b,d;return d=null,b=null,a.prototype.keyDownListener=function(a){this.states[a.keyCode]=!0},a.prototype.keyUpListener=function(a){this.states[a.keyCode]&&(this.states[a.keyCode]=!1)},a.prototype.isDown=function(a){return this.states[a]},a.prototype.isUp=function(a){return!this.states[a]},a}()},{"../../../example":1}],29:[function(a){"use strict";var b;b=a("../../example"),b.Main=function(){function a(){var a;a=this.canvas(),b=new b.Asteroids(a.getContext("2d"),a.width,a.height),b.start()}return a.prototype.canvas=function(){var a;return a=document.createElement(navigator.isCocoonJS?"screencanvas":"canvas"),a.width=window.innerWidth*window.devicePixelRatio,a.height=window.innerHeight*window.devicePixelRatio,a.style.width="100%",a.style.height="100%",a.style.backgroundColor="#000000",document.body.appendChild(a),a},a}()},{"../../example":1}],30:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.AnimationNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={animation:c.components.Animation},b.prototype.animation=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],31:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.AsteroidCollisionNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={asteroid:c.components.Asteroid,position:c.components.Position,collision:c.components.Collision,audio:c.components.Audio},b.prototype.asteroid=null,b.prototype.position=null,b.prototype.collision=null,b.prototype.audio=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],32:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.AudioNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={audio:c.components.Audio},b.prototype.audio=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],33:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.BulletAgeNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={bullet:c.components.Bullet},b.prototype.bullet=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],34:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.BulletCollisionNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={bullet:c.components.Bullet,position:c.components.Position,collision:c.components.Collision},b.prototype.bullet=null,b.prototype.position=null,b.prototype.collision=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],35:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.DeathThroesNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={death:c.components.DeathThroes},b.prototype.death=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],36:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.GameNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={state:c.components.GameState},b.prototype.state=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],37:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.GunControlNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={audio:c.components.Audio,control:c.components.GunControls,gun:c.components.Gun,position:c.components.Position},b.prototype.control=null,b.prototype.gun=null,b.prototype.position=null,b.prototype.audio=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],38:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.HudNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={state:c.components.GameState,hud:c.components.Hud},b.prototype.state=null,b.prototype.hud=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],39:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.MotionControlNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={control:c.components.MotionControls,position:c.components.Position,motion:c.components.Motion},b.prototype.control=null,b.prototype.position=null,b.prototype.motion=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],40:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.MovementNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={position:c.components.Position,motion:c.components.Motion},b.prototype.position=null,b.prototype.motion=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],41:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.RenderNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={position:c.components.Position,display:c.components.Display},b.prototype.position=null,b.prototype.display=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],42:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.SpaceshipCollisionNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={spaceship:c.components.Spaceship,position:c.components.Position,collision:c.components.Collision,audio:c.components.Audio},b.prototype.spaceship=0,b.prototype.position=0,b.prototype.collision=null,b.prototype.audio=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],43:[function(a){"use strict";var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.SpaceshipNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={spaceship:c.components.Spaceship,position:c.components.Position},b.prototype.spaceship=0,b.prototype.position=0,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],44:[function(a){"use strict";
var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=a("../../../lib"),c=a("../../../example"),c.nodes.WaitForStartNode=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.components={wait:c.components.WaitForStart},b.prototype.wait=null,b}(b.core.Node)},{"../../../example":1,"../../../lib":92}],45:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.AnimationNode,d.systems.AnimationSystem=function(a){function c(){this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.updateNode=function(a,b){a.animation.animation.animate(b)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],46:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.AudioNode,d.systems.AudioSystem=function(a){function c(){this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.updateNode=function(a){var b,c,d,e;e=a.audio.toPlay;for(b in e)d=e[b],c=new d,c.play(0,1);a.audio.toPlay.length=0},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],47:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.BulletAgeNode,d.systems.BulletAgeSystem=function(a){function c(a){this.creator=a,this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.creator=null,c.prototype.updateNode=function(a,b){var c;c=a.bullet,c.lifeRemaining-=b,c.lifeRemaining<=0&&this.creator.destroyEntity(a.entity)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],48:[function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=function(a,b){return function(){return a.apply(b,arguments)}},F={}.hasOwnProperty,G=function(a,b){function c(){this.constructor=a}for(var d in b)F.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};C=a("../../../lib"),D=a("../../../example"),y=D.nodes.SpaceshipCollisionNode,d=D.nodes.AsteroidCollisionNode,i=D.nodes.BulletCollisionNode,n=D.nodes.GameNode,b=D.components.Animation,c=D.components.Asteroid,g=D.components.Audio,h=D.components.Bullet,k=D.components.Collision,l=D.components.DeathThroes,m=D.components.Display,o=D.components.GameState,p=D.components.Gun,q=D.components.GunControls,r=D.components.Hud,t=D.components.Motion,u=D.components.MotionControls,v=D.components.Physics,w=D.components.Position,x=D.components.Spaceship,B=D.components.WaitForStart,e=D.graphics.AsteroidDeathView,f=D.graphics.AsteroidView,j=D.graphics.BulletView,s=D.graphics.HudView,z=D.graphics.SpaceshipDeathView,A=D.graphics.SpaceshipView,D.systems.CollisionSystem=function(a){function b(a){this.creator=a,this.update=E(this.update,this)}return G(b,a),b.prototype.creator=null,b.prototype.games=null,b.prototype.spaceships=null,b.prototype.asteroids=null,b.prototype.bullets=null,b.prototype.addToEngine=function(a){this.games=a.getNodeList(n),this.spaceships=a.getNodeList(y),this.asteroids=a.getNodeList(d),this.bullets=a.getNodeList(i)},b.prototype.removeFromEngine=function(){this.games=null,this.spaceships=null,this.asteroids=null,this.bullets=null},b.prototype.update=function(){var a,b,c;for(b=this.bullets.head;b;){for(a=this.asteroids.head;a;){if(a.position.position.distanceTo(b.position.position)<=a.collision.radius){this.creator.destroyEntity(b.entity),a.collision.radius>10&&(this.creator.createAsteroid(a.collision.radius-10,a.position.position.x+10*Math.random()-5,a.position.position.y+10*Math.random()-5),this.creator.createAsteroid(a.collision.radius-10,a.position.position.x+10*Math.random()-5,a.position.position.y+10*Math.random()-5)),a.asteroid.fsm.changeState("destroyed"),this.games.head&&this.games.head.state.hits++;break}a=a.next}b=b.next}for(c=this.spaceships.head;c;){for(a=this.asteroids.head;a;){if(a.position.position.distanceTo(c.position.position)<=a.collision.radius+c.collision.radius){c.spaceship.fsm.changeState("destroyed"),this.games.head&&this.games.head.state.lives++;break}a=a.next}c=c.next}},b}(C.core.System)},{"../../../example":1,"../../../lib":92}],49:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.DeathThroesNode,d.systems.DeathThroesSystem=function(a){function c(a){this.creator=a,this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.creator=null,c.prototype.updateNode=function(a,b){a.death.countdown-=b,a.death.countdown<=0&&this.creator.destroyEntity(a.entity)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],50:[function(a){"use strict";var b,c,d,e,f,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("../../../lib"),h=a("../../../example"),d=h.nodes.GameNode,f=h.nodes.SpaceshipNode,b=h.nodes.AsteroidCollisionNode,c=h.nodes.BulletCollisionNode,e=h.ui.Point,h.systems.GameManager=function(a){function g(a,b){this.creator=a,this.config=b,this.update=i(this.update,this)}return k(g,a),g.prototype.config=null,g.prototype.creator=null,g.prototype.gameNodes=null,g.prototype.spaceships=null,g.prototype.asteroids=null,g.prototype.bullets=null,g.prototype.addToEngine=function(a){this.gameNodes=a.getNodeList(d),this.spaceships=a.getNodeList(f),this.asteroids=a.getNodeList(b),this.bullets=a.getNodeList(c)},g.prototype.update=function(){var a,b,c,d,f,g,h,i;if(g=this.gameNodes.head,g&&g.state.playing){if(this.spaceships.empty)if(g.state.lives>0){for(f=new e(.5*this.config.width,.5*this.config.height),c=!0,a=this.asteroids.head;a;){if(e.distance(a.position.position,f)<=a.collision.radius+50){c=!1;break}a=a.next}c&&this.creator.createSpaceship()}else g.state.playing=!1,this.creator.createWaitForClick();if(this.asteroids.empty&&this.bullets.empty&&!this.spaceships.empty)for(i=this.spaceships.head,g.state.level++,b=2+g.state.level,d=0;b>d;){for(;;)if(h=new e(Math.random()*this.config.width,Math.random()*this.config.height),!(e.distance(h,i.position.position)<=80))break;this.creator.createAsteroid(30,h.x,h.y),++d}}},g.prototype.removeFromEngine=function(){this.gameNodes=null,this.spaceships=null,this.asteroids=null,this.bullets=null},g}(g.core.System)},{"../../../example":1,"../../../lib":92}],51:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.GunControlNode,d.systems.GunControlSystem=function(a){function c(a,d){this.keyPoll=a,this.creator=d,this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.keyPoll=null,c.prototype.creator=null,c.prototype.nodeList=null,c.prototype.updateNode=function(a,b){var c,d,e;c=a.control,e=a.position,d=a.gun,d.shooting=this.keyPoll.isDown(c.trigger),d.timeSinceLastShot+=b,d.shooting&&d.timeSinceLastShot>=d.minimumShotInterval&&(this.creator.createUserBullet(d,e),d.timeSinceLastShot=0)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],52:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.HudNode,d.systems.HudSystem=function(a){function c(){this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.updateNode=function(a){a.hud.view.setLives(a.state.lives),a.hud.view.setScore(a.state.hits)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],53:[function(a){"use strict";var b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.MotionControlNode,e=Box2D.Common.Math.b2Vec2,d.systems.MotionControlSystem=function(a){function c(a){this.keyPoll=a,this.updateNode=f(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return h(c,a),c.prototype.keyPoll=null,c.prototype.updateNode=function(a,b){var c,d,e,f,g;c=a.control,f=a.position,e=a.motion,d=this.keyPoll.isDown(c.left),g=this.keyPoll.isDown(c.right),d&&(f.rotation-=c.rotationRate*b),g&&(f.rotation+=c.rotationRate*b),this.keyPoll.isDown(c.accelerate)&&(e.velocity.x+=Math.cos(f.rotation)*c.accelerationRate*b,e.velocity.y+=Math.sin(f.rotation)*c.accelerationRate*b)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],54:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.MovementNode,d.systems.MovementSystem=function(a){function c(a){this.config=a,this.updateNode=e(this.updateNode,this),c.__super__.constructor.call(this,b,this.updateNode)}return g(c,a),c.prototype.config=null,c.prototype.updateNode=function(a,b){var c,d,e,f;d=a.position,c=a.motion,d.position.x+=c.velocity.x*b,d.position.y+=c.velocity.y*b,d.position.x<0&&(d.position.x+=this.config.width),d.position.x>this.config.width&&(d.position.x-=this.config.width),d.position.y<0&&(d.position.y+=this.config.height),d.position.y>this.config.height&&(d.position.y-=this.config.height),d.rotation+=c.angularVelocity*b,c.damping>0&&(e=Math.abs(Math.cos(d.rotation)*c.damping*b),f=Math.abs(Math.sin(d.rotation)*c.damping*b),c.velocity.x>e?c.velocity.x-=e:c.velocity.x<-e?c.velocity.x+=e:c.velocity.x=0,c.velocity.y>f?c.velocity.y-=f:c.velocity.y<-f?c.velocity.y+=f:c.velocity.y=0)},c}(c.tools.ListIteratingSystem)},{"../../../example":1,"../../../lib":92}],55:[function(a){"use strict";var b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),d=a("../../../example"),b=d.nodes.RenderNode,d.systems.RenderSystem=function(a){function c(a){this.graphic=a,this.update=e(this.update,this)}return g(c,a),c.prototype.graphic=null,c.prototype.nodes=null,c.prototype.addToEngine=function(a){var c;for(this.nodes=a.getNodeList(b),c=this.nodes.head;c;)this.addToDisplay(c),c=c.next},c.prototype.addToDisplay=function(){},c.prototype.removeFromDisplay=function(){},c.prototype.removeFromEngine=function(){this.nodes=null},c.prototype.update=function(){var a,b,c,d;for(this.graphic.save(),this.graphic.translate(0,0),this.graphic.rotate(0),this.graphic.clearRect(0,0,this.graphic.canvas.width,this.graphic.canvas.height),c=this.nodes.head;c;)a=c.display,b=a.graphic,d=c.position,b.x=d.position.x,b.y=d.position.y,b.rotation=d.rotation,b.draw(),c=c.next;this.graphic.restore()},c}(c.core.System)},{"../../../example":1,"../../../lib":92}],56:[function(a){"use strict";var b;b=a("../../../example"),b.systems.SystemPriorities=function(){function a(){}return a.preUpdate=1,a.update=2,a.move=3,a.resolveCollisions=4,a.stateMachines=5,a.animate=6,a.render=7,a}()},{"../../../example":1}],57:[function(a){"use strict";var b,c,d,e,f,g=function(a,b){return function(){return a.apply(b,arguments)}},h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../../../lib"),f=a("../../../example"),d=f.nodes.WaitForStartNode,b=f.nodes.AsteroidCollisionNode,c=f.nodes.GameNode,f.systems.WaitForStartSystem=function(a){function e(a){this.creator=a,this.update=g(this.update,this)}return i(e,a),e.prototype.engine=null,e.prototype.creator=null,e.prototype.gameNodes=null,e.prototype.waitNodes=null,e.prototype.asteroids=null,e.prototype.addToEngine=function(a){this.engine=a,this.waitNodes=a.getNodeList(d),this.gameNodes=a.getNodeList(c),this.asteroids=a.getNodeList(b)},e.prototype.removeFromEngine=function(){this.waitNodes=null,this.gameNodes=null},e.prototype.update=function(){var a,b,c;if(c=this.waitNodes.head,b=this.gameNodes.head,c&&c.wait.startGame&&b){for(a=this.asteroids.head;a;)this.creator.destroyEntity(a.entity),a=a.next;b.state.setForStart(),c.wait.startGame=!1,this.engine.removeEntity(c.entity)}},e}(e.core.System)},{"../../../example":1,"../../../lib":92}],58:[function(a){"use strict";var b;b=a("../../index"),b.ui.Point=function(){function a(a,b){this.x=null!=a?a:0,this.y=null!=b?b:0}return a.prototype.x=0,a.prototype.y=0,a.distance=function(a,b){var c,d;return c=a.x-b.x,d=a.y-b.y,Math.sqrt(c*c+d*d)},a.prototype.distanceSquaredTo=function(a){var b,c;return b=this.x-a.x,c=this.y-a.y,b*b+c*c},a.prototype.distanceTo=function(a){var b,c;return b=this.x-a.x,c=this.y-a.y,Math.sqrt(b*b+c*c)},a}()},{"../../index":1}],59:[function(a){"use strict";var b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};e=a("../../../lib"),c=e.core.NodeList,d=e.core.NodePool,b=function(){function a(){}return a}(),e.core.ComponentMatchingFamily=function(){function a(a,b){this.nodeClass=a,this.engine=b,this.releaseNodePoolCache=f(this.releaseNodePoolCache,this),this.init()}return a.prototype.nodes=null,a.prototype.entities=null,a.prototype.nodeClass=null,a.prototype.components=null,a.prototype.nodePool=null,a.prototype.engine=null,a.prototype.init=function(){var a,e,f;this.nodes=new c,this.entities=new b,this.components=new b,this.nodePool=new d(this.nodeClass,this.nodeClass.components),f=this.nodeClass.components;for(a in f)e=f[a],this.components[e.name]=e},Object.defineProperties(a.prototype,{nodeList:{get:function(){return this.nodes}}}),a.prototype.newEntity=function(a){this.addIfMatch(a)},a.prototype.componentAddedToEntity=function(a){this.addIfMatch(a)},a.prototype.componentRemovedFromEntity=function(a,b){var c;c=null!=b.name?b.name:b,c in this.components&&this.removeIfMatch(a)},a.prototype.removeEntity=function(a){this.removeIfMatch(a)},a.prototype.addIfMatch=function(a){var b,c,d,e,f;if(null==this.entities[a.name]){e=this.nodeClass.components;for(c in e)if(b=e[c],!a.has(b))return;d=this.nodePool.get(),d.entity=a,f=this.nodeClass.components;for(c in f)b=f[c],d[c]=a.get(b);this.entities[a.name]=d,this.nodes.add(d)}},a.prototype.removeIfMatch=function(a){var b;a.name in this.entities&&(b=this.entities[a.name],delete this.entities[a.name],this.nodes.remove(b),this.engine.updating?(this.nodePool.cache(b),this.engine.updateComplete.add(this.releaseNodePoolCache)):this.nodePool.dispose(b))},a.prototype.releaseNodePoolCache=function(){this.engine.updateComplete.remove(this.releaseNodePoolCache),this.nodePool.releaseCache()},a.prototype.cleanUp=function(){var a;for(a=this.nodes.head;a;)this.entities.remove(a.entity),a=a.next;this.nodes.removeAll()},a}()},{"../../../lib":92}],60:[function(a){"use strict";var b,c,d,e,f,g,h=function(a,b){return function(){return a.apply(b,arguments)}};g=a("../../../lib"),b=g.core.ComponentMatchingFamily,d=g.core.EntityList,e=g.signals.Signal0,f=g.core.SystemList,c=function(){function a(){}return a}(),g.core.Engine=function(){function a(){this.update=h(this.update,this),this.componentRemoved=h(this.componentRemoved,this),this.componentAdded=h(this.componentAdded,this),this.entityNameChanged=h(this.entityNameChanged,this),this.entityList=new d,this.entityNames=new c,this.systemList=new f,this.families=new c,this.updateComplete=new e}return a.prototype.entityNames=null,a.prototype.entityList=null,a.prototype.systemList=null,a.prototype.families=null,a.prototype.updating=!1,a.prototype.updateComplete=null,a.prototype.familyClass=b,Object.defineProperties(a.prototype,{entities:{get:function(){var a,b;for(a=[],b=this.entityList.head;b;)this.entities.push(b),b=b.next;return a}},systems:{get:function(){var a,b;for(b=[],a=this.systemList.head;a;)b.push(a),a=a.next;return b}}}),a.prototype.addEntity=function(a){var b,c,d;if(this.entityNames[a.name])throw"The entity name "+a.name+" is already in use by another entity.";this.entityList.add(a),this.entityNames[a.name]=a,a.componentAdded.add(this.componentAdded),a.componentRemoved.add(this.componentRemoved),a.nameChanged.add(this.entityNameChanged),d=this.families;for(b in d)c=d[b],c.newEntity(a)},a.prototype.removeEntity=function(a){var b,c,d;a.componentAdded.remove(this.componentAdded),a.componentRemoved.remove(this.componentRemoved),a.nameChanged.remove(this.entityNameChanged),d=this.families;for(b in d)c=d[b],c.removeEntity(a);delete this.entityNames[a.name],this.entityList.remove(a)},a.prototype.entityNameChanged=function(a,b){this.entityNames[b]===a&&(delete this.entityNames[b],this.entityNames[a.name]=a)},a.prototype.getEntityByName=function(a){return this.entityNames[a]},a.prototype.removeAllEntities=function(){for(;null!==this.entityList.head;)this.removeEntity(this.entityList.head)},a.prototype.componentAdded=function(a,b){var c,d,e;e=this.families;for(c in e)d=e[c],d.componentAddedToEntity(a,b)},a.prototype.componentRemoved=function(a,b){var c,d,e;e=this.families;for(c in e)d=e[c],d.componentRemovedFromEntity(a,b)},a.prototype.getNodeList=function(a){var b,c;if(a.name in this.families)return this.families[a.name].nodeList;for(c=new this.familyClass(a,this),this.families[a.name]=c,b=this.entityList.head;b;)c.newEntity(b),b=b.next;return c.nodeList},a.prototype.releaseNodeList=function(a){a.name in this.families&&(this.families[a.name].cleanUp(),delete this.families[a.name])},a.prototype.addSystem=function(a,b){a.priority=b,a.addToEngine(this),this.systemList.add(a)},a.prototype.getSystem=function(a){return systemList.get(a)},a.prototype.removeSystem=function(a){this.systemList.remove(a),a.removeFromEngine(this)},a.prototype.removeAllSystems=function(){for(;null!==this.systemList.head;)this.removeSystem(this.systemList.head)},a.prototype.update=function(a){var b;for(this.updating=!0,b=this.systemList.head;b;)b.update(a),b=b.next;this.updating=!1,this.updateComplete.dispatch()},a}()},{"../../../lib":92}],61:[function(a){"use strict";var b,c,d;d=a("../../../lib"),c=d.signals.Signal2,b=function(){function a(){}return a}(),d.core.Entity=function(){function a(a){null==a&&(a=""),Object.defineProperties(this,{name:{get:function(){return this._name},set:function(a){var b;return this._name!==a?(b=this._name,this._name=a,this.nameChanged.dispatch(this,b)):void 0}}}),this.componentAdded=new c,this.componentRemoved=new c,this.nameChanged=new c,this.components=new b,this._name=""!==a?a:"_entity"+ ++d}var d;return d=0,a.prototype._name="",a.prototype.componentAdded=null,a.prototype.componentRemoved=null,a.prototype.nameChanged=null,a.prototype.previous=null,a.prototype.next=null,a.prototype.components=null,a.prototype.add=function(a,b){return null==b&&(b=a.constructor),b.name in this.components&&this.remove(b),this.components[b.name]=a,this.componentAdded.dispatch(this,b),this},a.prototype.remove=function(a){var b,c;return c=null!=a.name?a.name:a,b=this.components[c],b?(delete this.components[c],this.componentRemoved.dispatch(this,c),b):null},a.prototype.get=function(a){return this.components[a.name]},a.prototype.getAll=function(){var a,b,c,d,e;for(b=[],e=this.components,c=0,d=e.length;d>c;c++)a=e[c],b.push(a);return b},a.prototype.has=function(a){return a.name in this.components},a}()},{"../../../lib":92}],62:[function(a){"use strict";var b;b=a("../../../lib"),b.core.EntityList=function(){function a(){}return a.prototype.head=null,a.prototype.tail=null,a.prototype.add=function(a){this.head?(this.tail.next=a,a.previous=this.tail,a.next=null,this.tail=a):(this.head=this.tail=a,a.next=a.previous=null)},a.prototype.remove=function(a){this.head===a&&(this.head=this.head.next),this.tail===a&&(this.tail=this.tail.previous),a.previous&&(a.previous.next=a.next),a.next&&(a.next.previous=a.previous)},a.prototype.removeAll=function(){for(var a;this.head;)a=this.head,this.head=this.head.next,a.previous=null,a.next=null;this.tail=null},a}()},{"../../../lib":92}],63:[function(a){"use strict";var b;b=a("../../../lib"),b.core.Family=function(){function a(){Object.defineProperties(this,{nodeList:{get:function(){return this.nodes}}})}return a.prototype.nodes=null,a.prototype.newEntity=function(){throw new Error("Method must be overriden")},a.prototype.removeEntity=function(){throw new Error("Method must be overriden")},a.prototype.componentAddedToEntity=function(){throw new Error("Method must be overriden")},a.prototype.componentRemovedFromEntity=function(){throw new Error("Method must be overriden")},a.prototype.cleanUp=function(){throw new Error("Method must be overriden")},a}()},{"../../../lib":92}],64:[function(a){"use strict";var b;b=a("../../../lib"),b.core.Node=function(){function a(){}return a.prototype.entity=null,a.prototype.previous=null,a.prototype.next=null,a}()},{"../../../lib":92}],65:[function(a){"use strict";var b,c;c=a("../../../lib"),b=c.signals.Signal1,c.core.NodeList=function(){function a(){this.nodeAdded=new b,this.nodeRemoved=new b}return a.prototype.head=null,a.prototype.tail=null,a.prototype.nodeAdded=null,a.prototype.nodeRemoved=null,a.prototype.add=function(a){this.head?(this.tail.next=a,a.previous=this.tail,a.next=null,this.tail=a):(this.head=this.tail=a,a.next=a.previous=null),this.nodeAdded.dispatch(a)},a.prototype.remove=function(a){this.head===a&&(this.head=this.head.next),this.tail===a&&(this.tail=this.tail.previous),a.previous&&(a.previous.next=a.next),a.next&&(a.next.previous=a.previous),this.nodeRemoved.dispatch(a)},a.prototype.removeAll=function(){for(var a;this.head;)a=this.head,this.head=this.head.next,a.previous=null,a.next=null,this.nodeRemoved.dispatch(a);this.tail=null},Object.defineProperties(a.prototype,{empty:{get:function(){return null===this.head}}}),a.prototype.swap=function(a,b){var c;a.previous===b?(a.previous=b.previous,b.previous=a,b.next=a.next,a.next=b):b.previous===a?(b.previous=a.previous,a.previous=b,a.next=b.next,b.next=a):(c=a.previous,a.previous=b.previous,b.previous=c,c=a.next,a.next=b.next,b.next=c),this.head===a?this.head=b:this.head===b&&(this.head=a),this.tail===a?this.tail=b:this.tail===b&&(this.tail=a),null!==a.previous&&(a.previous.next=a),null!==b.previous&&(b.previous.next=b),null!==a.next&&(a.next.previous=a),null!==b.next&&(b.next.previous=b)},a.prototype.insertionSort=function(a){var b,c,d;if(this.head!==this.tail)for(d=this.head.next,b=d;null!==b;){for(d=b.next,c=b.previous;null!==c;){if(a(b,c)>=0){b!==c.next&&(this.tail===b&&(this.tail=b.previous),b.previous.next=b.next,null!==b.next&&(b.next.previous=b.previous),b.next=c.next,b.previous=c,b.next.previous=b,c.next=b);break}c=c.previous}null===c&&(this.tail===b&&(this.tail=b.previous),b.previous.next=b.next,null!==b.next&&(b.next.previous=b.previous),b.next=this.head,this.head.previous=b,b.previous=null,this.head=b),b=d}},a.prototype.mergeSort=function(a){var b,c,d,e;if(this.head!==this.tail){for(c=[],e=this.head;null!==e;){for(b=e;null!==b.next&&a(b,b.next)<=0;)b=b.next;d=b.next,e.previous=b.next=null,c.push(e),e=d}for(;c.length>1;)c.push(this.merge(c.shift(),c.shift(),a));for(this.tail=this.head=c[0];null!==this.tail.next;)this.tail=this.tail.next}},a.prototype.merge=function(a,b,c){var d,e;for(c(a,b)<=0?(d=e=a,a=a.next):(d=e=b,b=b.next);null!==a&&null!==b;)c(a,b)<=0?(e.next=a,a.previous=e,e=a,a=a.next):(e.next=b,b.previous=e,e=b,b=b.next);return null!==a?(e.next=a,a.previous=e):(e.next=b,b.previous=e),d},a}()},{"../../../lib":92}],66:[function(a){"use strict";var b;b=a("../../../lib"),b.core.NodePool=function(){function a(a,b){this.nodeClass=a,this.components=b}return a.prototype.tail=null,a.prototype.nodeClass=null,a.prototype.cacheTail=null,a.prototype.components=null,a.prototype.get=function(){var a;return this.tail?(a=this.tail,this.tail=this.tail.previous,a.previous=null,a):new this.nodeClass},a.prototype.dispose=function(a){var b;for(b in this.components)a[b]=null;a.entity=null,a.next=null,a.previous=this.tail,this.tail=a},a.prototype.cache=function(a){a.previous=this.cacheTail,this.cacheTail=a},a.prototype.releaseCache=function(){for(var a;this.cacheTail;)a=this.cacheTail,this.cacheTail=a.previous,this.dispose(a)},a}()},{"../../../lib":92}],67:[function(a){"use strict";var b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=a("../../../lib"),b.core.System=function(){function a(){this.update=c(this.update,this)}return a.prototype.previous=null,a.prototype.next=null,a.prototype.priority=0,a.prototype.addToEngine=function(){},a.prototype.removeFromEngine=function(){},a.prototype.update=function(){},a}()},{"../../../lib":92}],68:[function(a){"use strict";var b;b=a("../../../lib"),b.core.SystemList=function(){function a(){}return a.prototype.head=null,a.prototype.tail=null,a.prototype.add=function(a){var b;if(this.head){for(b=this.tail;b&&!(b.priority<=a.priority);)b=b.previous;b===this.tail?(this.tail.next=a,a.previous=this.tail,a.next=null,this.tail=a):b?(a.next=b.next,a.previous=b,b.next.previous=a,b.next=a):(a.next=this.head,a.previous=null,this.head.previous=a,this.head=a)}else this.head=this.tail=a,a.next=a.previous=null},a.prototype.remove=function(a){this.head===a&&(this.head=this.head.next),this.tail===a&&(this.tail=this.tail.previous),a.previous&&(a.previous.next=a.next),a.next&&(a.next.previous=a.previous)},a.prototype.removeAll=function(){for(var a;this.head;)a=this.head,this.head=this.head.next,a.previous=null,a.next=null;this.tail=null},a.prototype.get=function(a){var b;for(b=this.head;b;){if(b.constructor===a)return b;b=b.next}return null},a}()},{"../../../lib":92}],69:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.ComponentInstanceProvider=function(){function a(a){this.instance=a}return a.prototype.instance=null,a.prototype.getComponent=function(){return this.instance},Object.defineProperties(a.prototype,{identifier:{get:function(){return this.instance}}}),a}()},{"../../../lib":92}],70:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.ComponentSingletonProvider=function(){function a(a){this.componentType=a}return a.prototype.componentType=null,a.prototype.instance=null,a.prototype.getComponent=function(){return null==this.instance&&(this.instance=new this.componentType),this.instance},Object.defineProperties(a.prototype,{identifier:{get:function(){return this.getComponent()}}}),a}()},{"../../../lib":92}],71:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.ComponentTypeProvider=function(){function a(a){this.componentType=a}return a.prototype.componentType=null,a.prototype.getComponent=function(){return new this.componentType},Object.defineProperties(a.prototype,{identifier:{get:function(){return this.componentType}}}),a}()},{"../../../lib":92}],72:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.DynamicComponentProvider=function(){function a(a){this._closure=a}return a.prototype._closure=null,a.prototype.getComponent=function(){return this._closure},Object.defineProperties(a.prototype,{identifier:{get:function(){return this._closure}}}),a}()},{"../../../lib":92}],73:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.DynamicSystemProvider=function(){function a(a){this.method=a}return a.prototype.method=function(){},a.prototype.systemPriority=0,a.prototype.getSystem=function(){return this.method()},Object.defineProperties(a.prototype,{identifier:{get:function(){return this.method}},priority:{get:function(){return this.systemPriority},set:function(a){return this.systemPriority=a}}}),a}()},{"../../../lib":92}],74:[function(a){"use strict";var b,c,d,e,f;f=a("../../../lib"),d=f.fsm.SystemInstanceProvider,e=f.fsm.SystemSingletonProvider,b=f.fsm.DynamicSystemProvider,c=f.fsm.StateSystemMapping,f.fsm.EngineState=function(){function a(){this.providers=[]}return a.prototype.providers=null,a.prototype.addInstance=function(a){return this.addProvider(new d(a))},a.prototype.addSingleton=function(a){return this.addProvider(new e(a))},a.prototype.addMethod=function(a){return this.addProvider(new b(a))},a.prototype.addProvider=function(a){var b;return b=new c(this,a),this.providers.push(a),b},a}()},{"../../../lib":92}],75:[function(a){"use strict";var b,c,d;d=a("../../../lib"),c=d.fsm.EngineState,b=function(){function a(){}return a}(),d.fsm.EngineStateMachine=function(){function a(a){this.engine=a,this.states=new b}return a.prototype.engine=null,a.prototype.states=null,a.prototype.currentState=null,a.prototype.addState=function(a,b){return this.states[a]=b,this},a.prototype.createState=function(a){var b;return b=new c,this.states[a]=b,this},a.prototype.changeState=function(a){var c,d,e,f,g,h,i,j;if(e=this.states[a],null==e)throw new Error("Engine state "+a+" doesn't exist");if(e===this.currentState)return void(e=null);h=new b,i=e.providers;for(c in i)g=i[c],d=g.identifier,h[d]=g;if(currentState){j=this.currentState.providers;for(c in j)g=j[c],d=g.identifier,f=h[d],f?delete h[d]:this.engine.removeSystem(g.getSystem())}for(c in h)g=h[c],this.engine.addSystem(g.getSystem(),g.priority);return this.currentState=e},a}()},{"../../../lib":92}],76:[function(a){"use strict";var b,c,d;d=a("../../../lib"),c=d.fsm.StateComponentMapping,b=function(){function a(){}return a}(),d.fsm.EntityState=function(){function a(){this.providers=new b}return a.prototype.providers=null,a.prototype.add=function(a){return new c(this,a.name)},a.prototype.get=function(a){return this.providers[a]},a.prototype.has=function(a){return null!==this.providers[a]},a}()},{"../../../lib":92}],77:[function(a){"use strict";var b,c,d;d=a("../../../lib"),c=d.fsm.EntityState,b=function(){function a(){}return a}(),d.fsm.EntityStateMachine=function(){function a(a){this.entity=a,this.states=new b}return a.prototype.states=null,a.prototype.currentState=null,a.prototype.entity=null,a.prototype.addState=function(a,b){return this.states[a]=b,this},a.prototype.createState=function(a){var b;return b=new c,this.states[a]=b,b},a.prototype.changeState=function(a){var c,d,e,f;if(c=this.states[a],!c)throw new Error("Entity state "+a+" doesn't exist");if(c===this.currentState)return void(c=null);if(this.currentState){e=new b;for(f in c.providers)e[f]=c.providers[f];for(f in this.currentState.providers)d=e[f],d&&d.identifier===this.currentState.providers[f].identifier?delete e[f]:this.entity.remove(f)
}else e=c.providers;for(f in e)this.entity.add(e[f].getComponent());return this.currentState=c},a}()},{"../../../lib":92}],78:[function(a){"use strict";var b,c,d,e,f;f=a("../../../lib"),b=f.fsm.ComponentInstanceProvider,d=f.fsm.ComponentTypeProvider,c=f.fsm.ComponentSingletonProvider,e=f.fsm.DynamicComponentProvider,f.fsm.StateComponentMapping=function(){function a(a,b){this.creatingState=a,this.componentType=b,this.withType(b)}return a.prototype.componentType=null,a.prototype.creatingState=null,a.prototype.provider=null,a.prototype.withInstance=function(a){return this.setProvider(new b(a)),this},a.prototype.withType=function(a){return this.setProvider(new d(a)),this},a.prototype.withSingleton=function(a){return null==a&&(a=this.componentType),this.setProvider(new c(a)),this},a.prototype.withMethod=function(a){return this.setProvider(new e(a)),this},a.prototype.withProvider=function(a){return this.setProvider(a),this},a.prototype.add=function(a){return this.creatingState.add(a)},a.prototype.setProvider=function(a){return this.provider=a,this.creatingState.providers[this.componentType]=a},a}()},{"../../../lib":92}],79:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.StateSystemMapping=function(){function a(a,b){this.creatingState=a,this.provider=b}return a.prototype.creatingState=null,a.prototype.provider=null,a.prototype.withPriority=function(a){return this.provider.priority=a,this},a.prototype.addInstance=function(a){return creatingState.addInstance(a)},a.prototype.addSingleton=function(a){return creatingState.addSingleton(a)},a.prototype.addMethod=function(a){return creatingState.addMethod(a)},a.prototype.addProvider=function(a){return creatingState.addProvider(a)},a}()},{"../../../lib":92}],80:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.SystemInstanceProvider=function(){function a(a){this.instance=a}return a.prototype.instance=null,a.prototype.systemPriority=0,a.prototype.getSystem=function(){return this.instance},Object.defineProperties(a.prototype,{identifier:{get:function(){return this.instance}},priority:{get:function(){return this.systemPriority},set:function(a){return this.systemPriority=a}}}),a}()},{"../../../lib":92}],81:[function(a){"use strict";var b;b=a("../../../lib"),b.fsm.SystemSingletonProvider=function(){function a(a){this.componentType=a}return a.prototype.componentType=null,a.prototype.instance=null,a.prototype.systemPriority=0,a.prototype.getSystem=function(){return this.instance||(this.instance=new this.componentType),this.instance},Object.defineProperties(a.prototype,{identifier:{get:function(){return this.getSystem()}},priority:{get:function(){return this.systemPriority},set:function(a){return this.systemPriority=a}}}),a}()},{"../../../lib":92}],82:[function(a){"use strict";var b;b=a("../../../lib"),b.signals.ListenerNode=function(){function a(){}return a.prototype.previous=null,a.prototype.next=null,a.prototype.listener=null,a.prototype.once=!1,a}()},{"../../../lib":92}],83:[function(a){"use strict";var b,c;c=a("../../../lib"),b=c.signals.ListenerNode,c.signals.ListenerNodePool=function(){function a(){}return a.prototype.tail=null,a.prototype.cacheTail=null,a.prototype.get=function(){var a;return null!==this.tail?(a=this.tail,this.tail=this.tail.previous,a.previous=null,a):new b},a.prototype.dispose=function(a){a.listener=null,a.once=!1,a.next=null,a.previous=this.tail,this.tail=a},a.prototype.cache=function(a){a.listener=null,a.previous=this.cacheTail,this.cacheTail=a},a.prototype.releaseCache=function(){for(var a;null!==this.cacheTail;)a=this.cacheTail,this.cacheTail=a.previous,a.next=null,a.previous=this.tail,this.tail=a},a}()},{"../../../lib":92}],84:[function(a){"use strict";var b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b=a("../../../lib"),b.signals.Signal0=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.dispatch=function(){var a;for(this.startDispatch(),a=this.head;null!==a;)a.listener(),a.once&&this.remove(a.listener),a=a.next;return this.endDispatch()},b}(b.signals.SignalBase)},{"../../../lib":92}],85:[function(a){"use strict";var b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b=a("../../../lib"),b.signals.Signal1=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.dispatch=function(a){var b;for(this.startDispatch(),b=this.head;null!==b;)b.listener(a),b.once&&this.remove(b.listener),b=b.next;return this.endDispatch()},b}(b.signals.SignalBase)},{"../../../lib":92}],86:[function(a){"use strict";var b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b=a("../../../lib"),b.signals.Signal2=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.dispatch=function(a,b){var c;for(this.startDispatch(),c=this.head;c;)c.listener(a,b),c.once&&this.remove(c.listener),c=c.next;return this.endDispatch()},b}(b.signals.SignalBase)},{"../../../lib":92}],87:[function(a){"use strict";var b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};b=a("../../../lib"),b.signals.Signal3=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.dispatch=function(a,b,c){var d;for(this.startDispatch(),d=this.head;null!==d;)d.listener(a,b,c),d.once&&this.remove(d.listener),d=d.next;return this.endDispatch()},b}(b.signals.SignalBase)},{"../../../lib":92}],88:[function(a){"use strict";var b,c;c=a("../../../lib"),b=c.signals.ListenerNodePool,c.signals.SignalBase=function(){function a(){this.nodes=[],this.keys=[],this.listenerNodePool=new b,this.numListeners=0}return a.prototype.head=null,a.prototype.tail=null,a.prototype.numListeners=0,a.prototype.keys=null,a.prototype.nodes=null,a.prototype.listenerNodePool=null,a.prototype.toAddHead=null,a.prototype.toAddTail=null,a.prototype.dispatching=!1,a.prototype.startDispatch=function(){this.dispatching=!0},a.prototype.endDispatch=function(){this.dispatching=!1,this.toAddHead&&(this.head?(this.tail.next=this.toAddHead,this.toAddHead.previous=this.tail,this.tail=this.toAddTail):(this.head=this.toAddHead,this.tail=this.toAddTail),this.toAddHead=null,this.toAddTail=null),this.listenerNodePool.releaseCache()},a.prototype.getNode=function(a){var b;for(b=this.head;null!==b&&b.listener!==a;)b=b.next;if(null===b)for(b=this.toAddHead;null!==b&&b.listener!==a;)b=b.next;return b},a.prototype.add=function(a){var b;-1===this.keys.indexOf(a)&&(b=this.listenerNodePool.get(),b.listener=a,this.nodes.push(b),this.keys.push(a),this.addNode(b))},a.prototype.addOnce=function(a){var b;-1===this.keys.indexOf(a)&&(b=this.listenerNodePool.get(),b.listener=a,b.once=!0,this.nodes.push(b),this.keys.push(a),this.addNode(b))},a.prototype.addNode=function(a){this.dispatching?null===this.toAddHead?this.toAddHead=this.toAddTail=a:(this.toAddTail.next=a,a.previous=this.toAddTail,this.toAddTail=a):null===this.head?this.head=this.tail=a:(this.tail.next=a,a.previous=this.tail,this.tail=a),this.numListeners++},a.prototype.remove=function(a){var b,c;b=this.keys.indexOf(a),c=this.nodes[b],c&&(this.head===c&&(this.head=this.head.next),this.tail===c&&(this.tail=this.tail.previous),this.toAddHead===c&&(this.toAddHead=this.toAddHead.next),this.toAddTail===c&&(this.toAddTail=this.toAddTail.previous),c.previous&&(c.previous.next=c.next),c.next&&(c.next.previous=c.previous),this.nodes.splice(b,1),this.keys.splice(b,1),this.dispatching?this.listenerNodePool.cache(c):this.listenerNodePool.dispose(c),this.numListeners--)},a.prototype.removeAll=function(){for(var a;this.head;)a=this.head,this.head=this.head.next,this.nodes.splice(index,1),this.listenerNodePool.dispose(a);this.nodes=[],this.keys=[],this.tail=null,this.toAddHead=null,this.toAddTail=null,this.numListeners=0},a}()},{"../../../lib":92}],89:[function(a){"use strict";var b,c,d=function(a,b){return function(){return a.apply(b,arguments)}},e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../../lib"),b=c.signals.Signal1,c.tick.FrameTickProvider=function(a){function b(a,c){this.displayObject=a,this.maximumFrameTime=c,this.dispatchTick=d(this.dispatchTick,this),b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.displayObject=null,b.prototype.previousTime=0,b.prototype.maximumFrameTime=0,b.prototype.isPlaying=!1,b.prototype.request=null,b.prototype.timeAdjustment=1,Object.defineProperties(b.prototype,{playing:{get:function(){return this.isPlaying}}}),b.prototype.start=function(){this.request=requestAnimationFrame(this.dispatchTick),this.isPlaying=!0},b.prototype.stop=function(){cancelRequestAnimationFrame(this.request),this.isPlaying=!1},b.prototype.dispatchTick=function(a){var b,c;null==a&&(a=Date.now()),this.displayObject&&this.displayObject.begin(),c=this.previousTime||a,this.previousTime=a,b=.001*(a-c),this.dispatch(b),requestAnimationFrame(this.dispatchTick),this.displayObject&&this.displayObject.end()},b}(b)},{"../../../lib":92}],90:[function(a){"use strict";var b,c,d=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};c=a("../../../lib"),b=function(){function a(){}return a}(),c.tools.ComponentPool=function(){function a(){}var c,e;return e=new b,c=function(a){var b;return b=a.name,d.call(e,b)>=0?e[a.name]:e[a.name]=[]},a.get=function(a){var b;return b=c(a),b.length>0?b.pop():new a},a.dispose=function(a){var b,d;a&&(d=a.constructor,b=c(d),b.push(a))},a.empty=function(){return e=new b},a}()},{"../../../lib":92}],91:[function(a){"use strict";var b,c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("../../../lib"),b=f.core.Engine,c=f.core.Node,d=f.core.NodeList,e=f.core.System,f.tools.ListIteratingSystem=function(a){function b(a,b,c,d){null==c&&(c=null),null==d&&(d=null),this.nodeClass=a,this.nodeUpdateFunction=b,this.nodeAddedFunction=c,this.nodeRemovedFunction=d}return h(b,a),b.prototype.nodeList=null,b.prototype.nodeClass=null,b.prototype.nodeUpdateFunction=null,b.prototype.nodeAddedFunction=null,b.prototype.nodeRemovedFunction=null,b.prototype.addToEngine=function(a){var b;if(this.nodeList=a.getNodeList(this.nodeClass),null!==this.nodeAddedFunction){for(b=this.nodeList.head;b;)this.nodeAddedFunction(b),b=b.next;this.nodeList.nodeAdded.add(this.nodeAddedFunction)}null!==this.nodeRemovedFunction&&this.nodeList.nodeRemoved.add(this.nodeRemovedFunction)},b.prototype.removeFromEngine=function(){null!==this.nodeAddedFunction&&this.nodeList.nodeAdded.remove(this.nodeAddedFunction),null!==this.nodeRemovedFunction&&this.nodeList.nodeRemoved.remove(this.nodeRemovedFunction),this.nodeList=null},b.prototype.update=function(a){var b;for(b=this.nodeList.head;b;)this.nodeUpdateFunction(b,a),b=b.next},b}(e)},{"../../../lib":92}],92:[function(a,b){"use strict";var c;b.exports=c=function(){function a(){}return a}(),c.signals=function(){function a(){}return a}(),a("./ash/signals/listener_node"),a("./ash/signals/listener_node_pool"),a("./ash/signals/signal_base"),a("./ash/signals/signal0"),a("./ash/signals/signal1"),a("./ash/signals/signal2"),a("./ash/signals/signal3"),c.core=function(){function a(){}return a}(),a("./ash/core/entity"),a("./ash/core/entity_list"),a("./ash/core/node"),a("./ash/core/node_list"),a("./ash/core/node_pool"),a("./ash/core/system"),a("./ash/core/system_list"),a("./ash/core/family"),a("./ash/core/component_matching_family"),a("./ash/core/engine"),c.fsm=function(){function a(){}return a}(),a("./ash/fsm/component_instance_provider"),a("./ash/fsm/component_singleton_provider"),a("./ash/fsm/component_type_provider"),a("./ash/fsm/dynamic_component_provider"),a("./ash/fsm/dynamic_system_provider"),a("./ash/fsm/engine_state"),a("./ash/fsm/state_component_mapping"),a("./ash/fsm/engine_state_machine"),a("./ash/fsm/entity_state"),a("./ash/fsm/entity_state_machine"),a("./ash/fsm/state_system_mapping"),a("./ash/fsm/system_instance_provider"),a("./ash/fsm/system_singleton_provider"),c.tick=function(){function a(){}return a}(),a("./ash/tick/frame_tick_provider"),c.tools=function(){function a(){}return a}(),a("./ash/tools/component_pool"),a("./ash/tools/list_iterating_system")},{"./ash/core/component_matching_family":59,"./ash/core/engine":60,"./ash/core/entity":61,"./ash/core/entity_list":62,"./ash/core/family":63,"./ash/core/node":64,"./ash/core/node_list":65,"./ash/core/node_pool":66,"./ash/core/system":67,"./ash/core/system_list":68,"./ash/fsm/component_instance_provider":69,"./ash/fsm/component_singleton_provider":70,"./ash/fsm/component_type_provider":71,"./ash/fsm/dynamic_component_provider":72,"./ash/fsm/dynamic_system_provider":73,"./ash/fsm/engine_state":74,"./ash/fsm/engine_state_machine":75,"./ash/fsm/entity_state":76,"./ash/fsm/entity_state_machine":77,"./ash/fsm/state_component_mapping":78,"./ash/fsm/state_system_mapping":79,"./ash/fsm/system_instance_provider":80,"./ash/fsm/system_singleton_provider":81,"./ash/signals/listener_node":82,"./ash/signals/listener_node_pool":83,"./ash/signals/signal0":84,"./ash/signals/signal1":85,"./ash/signals/signal2":86,"./ash/signals/signal3":87,"./ash/signals/signal_base":88,"./ash/tick/frame_tick_provider":89,"./ash/tools/component_pool":90,"./ash/tools/list_iterating_system":91}]},{},[1])(1)});